generator client {
  provider = "prisma-client-js"
}

enum PaymentStatus {
  pending
  paid
  failed
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum Role {
  user
  seller
  admin
}

model User {
  id              String               @id @default(auto()) @map("_id") @db.ObjectId
  firebaseUid     String?
  email           String               @unique
  password        String?
  phone           String?              @unique
  role            Role                 @default(user)
  name            String
  createdAt       DateTime             @default(now())
  updatedAt       DateTime             @updatedAt
  status          Boolean              @default(true)
  userPermissions UserAreaPermission[] @relation("UserPermissions")
  authProvider   String
   avatar String
}

model UserAreaPermission {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  userId      String   @db.ObjectId
  areaId      String   @db.ObjectId
  permissions Json
  status      Boolean  @default(true)
  createdAt   DateTime @default(now())
  user        User     @relation("UserPermissions", fields: [userId], references: [id])
}

model ServiceArea {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  name        String
  description String?
  status      Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  services Service[] @relation("Services")
}

type Image {
  url       String
  thumbnail String?
  preview   String?
}

type AiPlatform {
  id   Int
  name String
  url  String?
}

model Prompt {
  id          String       @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  text        String
  images      Image[]
  aiPlatforms AiPlatform[] @map("ai_platforms")
  categoryId  String?      @db.ObjectId
  tags        String[]     @default([])
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  isLocked    Boolean    @default(false)
  createdBy  String?      @db.ObjectId
  interactions PromptInteraction[]  @relation("PromptToInteraction")
}

model PromptInteraction {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  promptId  String   @db.ObjectId
  ip        String?
  type      String // "view" | "like" | "share"
  createdAt DateTime @default(now())
  prompt Prompt @relation("PromptToInteraction", fields: [promptId], references: [id])
}

model Category {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  name        String   @unique
  slug        String?  @unique
  description String?
  image       String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Service {
  id             String        @id @default(auto()) @map("_id") @db.ObjectId
  title          String
  status         Boolean       @default(true)
  type           String        @default("card")
  imageUrl       String?
  isLottie       Boolean       @default(false)
  isClikableLink Boolean       @default(false)
  url            String?
  bannerImage    String[]
  serviceAreaId  String?       @db.ObjectId
  serviceArea    ServiceArea?  @relation("Services", fields: [serviceAreaId], references: [id])
  serviceList    ServiceList[] @relation("ServiceToServiceList") // This defines the relationship
}

model ServiceList {
  id               String            @id @default(auto()) @map("_id") @db.ObjectId
  serviceId        String            @db.ObjectId
  title            String
  shortDescription String?
  description      String?
  phoneNumber      String?
  type             String
  status           Boolean?          @default(true)
  isClikableLink   Boolean           @default(false)
  url              String
  isTouristSpot    Boolean           @default(false)
  isInternalUrl    Boolean
  imageUrl         String
  contentHtml      String?
  dynamicFields    Json?
  views            Int?              @default(0) // Optional total views
  upVotes          Int?              @default(0) // Optional upvotes
  downVotes        Int?              @default(0) // Optional downvotes
  createdAt        DateTime?         @default(now())
  service          Service           @relation("ServiceToServiceList", fields: [serviceId], references: [id]) // Relating to Service model
  blogs            TouristSpotBlog[] @relation("blogs")
}

model TouristSpotBlog {
  id            String      @id @default(auto()) @map("_id") @db.ObjectId
  serviceListId String      @db.ObjectId
  title         String
  slug          String      @unique
  contentHtml   String
  thumbnail     String?
  publishedAt   DateTime    @default(now())
  views         Int         @default(0)
  serviceList   ServiceList @relation("blogs", fields: [serviceListId], references: [id]) // Relating to ServiceList model
  // üëç Voting / Engagement
  upVotes       Int         @default(0)
  downVotes     Int         @default(0)
  likes         Int         @default(0)
}

model News {
  id               String   @id @default(auto()) @map("_id") @db.ObjectId
  title            String
  shortDescription String?
  description      String?
  slug             String   @unique
  tags             String[]
  isBreakingNews   Boolean  @default(false)
  thumbnailUrl     String?
  type             String   @default("rss")
  newsUrl          String?
  isExternalNews   Boolean  @default(true)
  imageUrl         String?
  videoUrl         String?
  videoEmbed       String?
  hasVideo         Boolean  @default(false)
  authorName       String?
  publishedAt      DateTime @default(now())
  like             Int      @default(0)
  comment          Int      @default(0)

  aiSummary         String?
  aiCategory        String?
  aiImportanceScore Int?
  imageQuality      Float?
  imageAltText      String?
  lastProcessed     DateTime?
}

model BreakingNews {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  newsTitle String
  content   String?
  status    Boolean  @default(true)
  order     Int      @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([status])
}
